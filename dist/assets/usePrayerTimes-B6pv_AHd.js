var ct=Object.defineProperty;var lt=(t,e,n)=>e in t?ct(t,e,{enumerable:!0,configurable:!0,writable:!0,value:n}):t[e]=n;var v=(t,e,n)=>lt(t,typeof e!="symbol"?e+"":e,n);import{M as W,r as P,c as V}from"./index-DYnd7MgS.js";const J={Shafi:"shafi",Hanafi:"hanafi"};function mt(t){switch(t){case J.Shafi:return 1;case J.Hanafi:return 2;default:throw"Invalid Madhab"}}const x={MiddleOfTheNight:"middleofthenight",SeventhOfTheNight:"seventhofthenight",TwilightAngle:"twilightangle"};class nt{constructor(e,n){this.latitude=e,this.longitude=n}}const E={Nearest:"nearest",Up:"up",None:"none"};function q(t,e){const n=t.getFullYear(),s=t.getMonth(),r=t.getDate()+e,o=t.getHours(),i=t.getMinutes(),a=t.getSeconds();return new Date(n,s,r,o,i,a)}function O(t,e){return L(t,e*60)}function L(t,e){return new Date(t.getTime()+e*1e3)}function C(t,e=E.Nearest){const n=t.getUTCSeconds();let s=n>=30?60-n:-1*n;return e===E.Up?s=60-n:e===E.None&&(s=0),L(t,s)}function tt(t){let e=0;const s=[31,m.isLeapYear(t.getFullYear())?29:28,31,30,31,30,31,31,30,31,30,31];for(let r=0;r<t.getMonth();r++)e+=s[r];return e+=t.getDate(),e}function et(t){return t instanceof Date&&!isNaN(t.valueOf())}function g(t){return t*Math.PI/180}function F(t){return t*180/Math.PI}function st(t,e){return t-e*Math.floor(t/e)}function A(t){return st(t,360)}function gt(t){return t>=-180&&t<=180?t:t-360*Math.round(t/360)}const $={General:"general",Ahmer:"ahmer",Abyad:"abyad"},m={meanSolarLongitude(t){const e=t,n=280.4664567,s=36000.76983*e,r=3032e-7*Math.pow(e,2),o=n+s+r;return A(o)},meanLunarLongitude(t){const e=t,n=218.3165,s=481267.8813*e,r=n+s;return A(r)},ascendingLunarNodeLongitude(t){const e=t,n=125.04452,s=1934.136261*e,r=.0020708*Math.pow(e,2),o=Math.pow(e,3)/45e4,i=n-s+r+o;return A(i)},meanSolarAnomaly(t){const e=t,n=357.52911,s=35999.05029*e,r=1537e-7*Math.pow(e,2),o=n+s-r;return A(o)},solarEquationOfTheCenter(t,e){const n=t,s=g(e),r=(1.914602-.004817*n-14e-6*Math.pow(n,2))*Math.sin(s),o=(.019993-101e-6*n)*Math.sin(2*s),i=289e-6*Math.sin(3*s);return r+o+i},apparentSolarLongitude(t,e){const n=t,r=e+m.solarEquationOfTheCenter(n,m.meanSolarAnomaly(n)),o=125.04-1934.136*n,i=r-.00569-.00478*Math.sin(g(o));return A(i)},meanObliquityOfTheEcliptic(t){const e=t,n=23.439291,s=.013004167*e,r=1639e-10*Math.pow(e,2),o=5036e-10*Math.pow(e,3);return n-s-r+o},apparentObliquityOfTheEcliptic(t,e){const n=t,s=e,r=125.04-1934.136*n;return s+.00256*Math.cos(g(r))},meanSiderealTime(t){const e=t,n=e*36525+2451545,s=280.46061837,r=360.98564736629*(n-2451545),o=387933e-9*Math.pow(e,2),i=Math.pow(e,3)/3871e4,a=s+r+o-i;return A(a)},nutationInLongitude(t,e,n,s){const r=e,o=n,i=s,a=-17.2/3600*Math.sin(g(i)),u=1.32/3600*Math.sin(2*g(r)),h=.23/3600*Math.sin(2*g(o)),c=.21/3600*Math.sin(2*g(i));return a-u-h+c},nutationInObliquity(t,e,n,s){const r=e,o=n,i=s,a=9.2/3600*Math.cos(g(i)),u=.57/3600*Math.cos(2*g(r)),h=.1/3600*Math.cos(2*g(o)),c=.09/3600*Math.cos(2*g(i));return a+u+h-c},altitudeOfCelestialBody(t,e,n){const s=t,r=e,o=n,i=Math.sin(g(s))*Math.sin(g(r)),a=Math.cos(g(s))*Math.cos(g(r))*Math.cos(g(o));return F(Math.asin(i+a))},approximateTransit(t,e,n){const s=t,r=e,o=n,i=s*-1;return st((o+i-r)/360,1)},correctedTransit(t,e,n,s,r,o){const i=t,a=e,u=n,h=s,c=r,d=o,l=a*-1,M=A(u+360.985647*i),p=A(m.interpolateAngles(h,c,d,i)),N=gt(M-l-p)/-360;return(i+N)*24},correctedHourAngle(t,e,n,s,r,o,i,a,u,h,c){const d=t,l=e,M=r,p=o,j=i,N=a,D=u,R=h,K=c,Q=n.longitude*-1,k=Math.sin(g(l))-Math.sin(g(n.latitude))*Math.sin(g(D)),G=Math.cos(g(n.latitude))*Math.cos(g(D)),U=F(Math.acos(k/G)),Y=s?d+U/360:d-U/360,T=A(M+360.985647*Y),I=A(m.interpolateAngles(p,j,N,Y)),X=m.interpolate(D,R,K,Y),Z=T-Q-I,at=m.altitudeOfCelestialBody(n.latitude,X,Z)-l,ht=360*Math.cos(g(X))*Math.cos(g(n.latitude))*Math.sin(g(Z)),ut=at/ht;return(Y+ut)*24},interpolate(t,e,n,s){const r=t-e,o=n-t,i=o-r;return t+s/2*(r+o+s*i)},interpolateAngles(t,e,n,s){const r=A(t-e),o=A(n-t),i=o-r;return t+s/2*(r+o+s*i)},julianDay(t,e,n,s=0){const r=Math.trunc,o=r(e>2?t:t-1),i=r(e>2?e:e+12),a=n+s/24,u=r(o/100),h=r(2-u+r(u/4)),c=r(365.25*(o+4716)),d=r(30.6001*(i+1));return c+d+a+h-1524.5},julianCentury(t){return(t-2451545)/36525},isLeapYear(t){return!(t%4!==0||t%100===0&&t%400!==0)},seasonAdjustedMorningTwilight(t,e,n,s){const r=75+.5209090909090909*Math.abs(t),o=75+19.44/55*Math.abs(t),i=75+32.74/55*Math.abs(t),a=75+48.1/55*Math.abs(t),u=(function(){const h=m.daysSinceSolstice(e,n,t);return h<91?r+(o-r)/91*h:h<137?o+(i-o)/46*(h-91):h<183?i+(a-i)/46*(h-137):h<229?a+(i-a)/46*(h-183):h<275?i+(o-i)/46*(h-229):o+(r-o)/91*(h-275)})();return L(s,Math.round(u*-60))},seasonAdjustedEveningTwilight(t,e,n,s,r){let o,i,a,u;r===$.Ahmer?(o=62+17.4/55*Math.abs(t),i=62-7.16/55*Math.abs(t),a=62+5.12/55*Math.abs(t),u=62+19.44/55*Math.abs(t)):r===$.Abyad?(o=75+25.6/55*Math.abs(t),i=75+7.16/55*Math.abs(t),a=75+36.84/55*Math.abs(t),u=75+81.84/55*Math.abs(t)):(o=75+25.6/55*Math.abs(t),i=75+2.05/55*Math.abs(t),a=75-9.21/55*Math.abs(t),u=75+6.14/55*Math.abs(t));const h=(function(){const c=m.daysSinceSolstice(e,n,t);return c<91?o+(i-o)/91*c:c<137?i+(a-i)/46*(c-91):c<183?a+(u-a)/46*(c-137):c<229?u+(a-u)/46*(c-183):c<275?a+(i-a)/46*(c-229):i+(o-i)/91*(c-275)})();return L(s,Math.round(h*60))},daysSinceSolstice(t,e,n){let s=0;const r=10,o=m.isLeapYear(e)?173:172,i=m.isLeapYear(e)?366:365;return n>=0?(s=t+r,s>=i&&(s=s-i)):(s=t-o,s<0&&(s=s+i)),s}};class _{constructor(e){const n=m.julianCentury(e),s=m.meanSolarLongitude(n),r=m.meanLunarLongitude(n),o=m.ascendingLunarNodeLongitude(n),i=g(m.apparentSolarLongitude(n,s)),a=m.meanSiderealTime(n),u=m.nutationInLongitude(n,s,r,o),h=m.nutationInObliquity(n,s,r,o),c=m.meanObliquityOfTheEcliptic(n),d=g(m.apparentObliquityOfTheEcliptic(n,c));this.declination=F(Math.asin(Math.sin(d)*Math.sin(i))),this.rightAscension=A(F(Math.atan2(Math.cos(d)*Math.sin(i),Math.cos(i)))),this.apparentSiderealTime=a+u*3600*Math.cos(g(c+h))/3600}}class y{constructor(e,n){const s=m.julianDay(e.getFullYear(),e.getMonth()+1,e.getDate(),0);this.observer=n,this.solar=new _(s),this.prevSolar=new _(s-1),this.nextSolar=new _(s+1);const r=m.approximateTransit(n.longitude,this.solar.apparentSiderealTime,this.solar.rightAscension),o=-50/60;this.approxTransit=r,this.transit=m.correctedTransit(r,n.longitude,this.solar.apparentSiderealTime,this.solar.rightAscension,this.prevSolar.rightAscension,this.nextSolar.rightAscension),this.sunrise=m.correctedHourAngle(r,o,n,!1,this.solar.apparentSiderealTime,this.solar.rightAscension,this.prevSolar.rightAscension,this.nextSolar.rightAscension,this.solar.declination,this.prevSolar.declination,this.nextSolar.declination),this.sunset=m.correctedHourAngle(r,o,n,!0,this.solar.apparentSiderealTime,this.solar.rightAscension,this.prevSolar.rightAscension,this.nextSolar.rightAscension,this.solar.declination,this.prevSolar.declination,this.nextSolar.declination)}hourAngle(e,n){return m.correctedHourAngle(this.approxTransit,e,this.observer,n,this.solar.apparentSiderealTime,this.solar.rightAscension,this.prevSolar.rightAscension,this.nextSolar.rightAscension,this.solar.declination,this.prevSolar.declination,this.nextSolar.declination)}afternoon(e){const n=Math.abs(this.observer.latitude-this.solar.declination),s=e+Math.tan(g(n)),r=F(Math.atan(1/s));return this.hourAngle(r,!0)}}const H={AqrabBalad:"AqrabBalad",AqrabYaum:"AqrabYaum",Unresolved:"Unresolved"},rt=.5,dt=65,B=t=>!isNaN(t.sunrise)&&!isNaN(t.sunset),ot=(t,e,n=1,s=1)=>{if(n>Math.ceil(365/2))return null;const r=new Date(e.getTime());r.setDate(r.getDate()+s*n);const o=q(r,1),i=new y(r,t),a=new y(o,t);return!B(i)||!B(a)?ot(t,e,n+(s>0?0:1),-s):{date:e,tomorrow:o,coordinates:t,solarTime:i,tomorrowSolarTime:a}},it=(t,e,n)=>{const s=new y(e,{...t,latitude:n}),r=q(e,1),o=new y(r,{...t,latitude:n});return!B(s)||!B(o)?Math.abs(n)>=dt?it(t,e,n-Math.sign(n)*rt):null:{date:e,tomorrow:r,coordinates:new nt(n,t.longitude),solarTime:s,tomorrowSolarTime:o}},ft=(t,e,n)=>{const s={date:e,tomorrow:q(e,1),coordinates:n,solarTime:new y(e,n),tomorrowSolarTime:new y(q(e,1),n)};switch(t){case H.AqrabYaum:return ot(n,e)||s;case H.AqrabBalad:{const{latitude:r}=n;return it(n,e,r-Math.sign(r)*rt)||s}default:return s}};class w{constructor(e,n=0,s=0,r=0,o=0){v(this,"madhab",J.Shafi);v(this,"highLatitudeRule",x.MiddleOfTheNight);v(this,"adjustments",{fajr:0,sunrise:0,dhuhr:0,asr:0,maghrib:0,isha:0});v(this,"methodAdjustments",{fajr:0,sunrise:0,dhuhr:0,asr:0,maghrib:0,isha:0});v(this,"polarCircleResolution",H.Unresolved);v(this,"rounding",E.Nearest);v(this,"shafaq",$.General);this.method=e,this.fajrAngle=n,this.ishaAngle=s,this.ishaInterval=r,this.maghribAngle=o,this.method===null&&(this.method="Other")}nightPortions(){switch(this.highLatitudeRule){case x.MiddleOfTheNight:return{fajr:1/2,isha:1/2};case x.SeventhOfTheNight:return{fajr:1/7,isha:1/7};case x.TwilightAngle:return{fajr:this.fajrAngle/60,isha:this.ishaAngle/60};default:throw`Invalid high latitude rule found when attempting to compute night portions: ${this.highLatitudeRule}`}}}const S={MuslimWorldLeague(){const t=new w("MuslimWorldLeague",18,17);return t.methodAdjustments.dhuhr=1,t},Egyptian(){const t=new w("Egyptian",19.5,17.5);return t.methodAdjustments.dhuhr=1,t},Karachi(){const t=new w("Karachi",18,18);return t.methodAdjustments.dhuhr=1,t},UmmAlQura(){return new w("UmmAlQura",18.5,0,90)},Dubai(){const t=new w("Dubai",18.2,18.2);return t.methodAdjustments={...t.methodAdjustments,sunrise:-3,dhuhr:3,asr:3,maghrib:3},t},MoonsightingCommittee(){const t=new w("MoonsightingCommittee",18,18);return t.methodAdjustments={...t.methodAdjustments,dhuhr:5,maghrib:3},t},NorthAmerica(){const t=new w("NorthAmerica",15,15);return t.methodAdjustments.dhuhr=1,t},Kuwait(){return new w("Kuwait",18,17.5)},Qatar(){return new w("Qatar",18,0,90)},Singapore(){const t=new w("Singapore",20,18);return t.methodAdjustments.dhuhr=1,t.rounding=E.Up,t}},f={Fajr:"fajr",Sunrise:"sunrise",Dhuhr:"dhuhr",Asr:"asr",Maghrib:"maghrib",Isha:"isha",None:"none"};class b{constructor(e){return this.hours=Math.floor(e),this.minutes=Math.floor((e-this.hours)*60),this.seconds=Math.floor((e-(this.hours+this.minutes/60))*60*60),this}utcDate(e,n,s){return new Date(Date.UTC(e,n,s,this.hours,this.minutes,this.seconds))}}class Mt{constructor(e,n,s){this.coordinates=e,this.date=n,this.calculationParameters=s;let r=new y(n,e),o,i,a,u,h,c,d,l;a=new b(r.transit).utcDate(n.getFullYear(),n.getMonth(),n.getDate()),i=new b(r.sunrise).utcDate(n.getFullYear(),n.getMonth(),n.getDate()),h=new b(r.sunset).utcDate(n.getFullYear(),n.getMonth(),n.getDate());const M=q(n,1);let p=new y(M,e);const j=s.polarCircleResolution;if((!et(i)||!et(h)||isNaN(p.sunrise))&&j!==H.Unresolved){const T=ft(j,n,e);r=T.solarTime,p=T.tomorrowSolarTime;const I=[n.getFullYear(),n.getMonth(),n.getDate()];a=new b(r.transit).utcDate(...I),i=new b(r.sunrise).utcDate(...I),h=new b(r.sunset).utcDate(...I)}u=new b(r.afternoon(mt(s.madhab))).utcDate(n.getFullYear(),n.getMonth(),n.getDate());const N=new b(p.sunrise).utcDate(M.getFullYear(),M.getMonth(),M.getDate()),D=(Number(N)-Number(h))/1e3;o=new b(r.hourAngle(-1*s.fajrAngle,!1)).utcDate(n.getFullYear(),n.getMonth(),n.getDate()),s.method==="MoonsightingCommittee"&&e.latitude>=55&&(l=D/7,o=L(i,-l));const R=(function(){return s.method==="MoonsightingCommittee"?m.seasonAdjustedMorningTwilight(e.latitude,tt(n),n.getFullYear(),i):(l=s.nightPortions().fajr*D,L(i,-l))})();if((isNaN(o.getTime())||R>o)&&(o=R),s.ishaInterval>0)d=O(h,s.ishaInterval);else{d=new b(r.hourAngle(-1*s.ishaAngle,!0)).utcDate(n.getFullYear(),n.getMonth(),n.getDate()),s.method==="MoonsightingCommittee"&&e.latitude>=55&&(l=D/7,d=L(h,l));const T=(function(){return s.method==="MoonsightingCommittee"?m.seasonAdjustedEveningTwilight(e.latitude,tt(n),n.getFullYear(),h,s.shafaq):(l=s.nightPortions().isha*D,L(h,l))})();(isNaN(d.getTime())||T<d)&&(d=T)}if(c=h,s.maghribAngle){const T=new b(r.hourAngle(-1*s.maghribAngle,!0)).utcDate(n.getFullYear(),n.getMonth(),n.getDate());h<T&&d>T&&(c=T)}const K=(s.adjustments.fajr||0)+(s.methodAdjustments.fajr||0),Q=(s.adjustments.sunrise||0)+(s.methodAdjustments.sunrise||0),k=(s.adjustments.dhuhr||0)+(s.methodAdjustments.dhuhr||0),G=(s.adjustments.asr||0)+(s.methodAdjustments.asr||0),U=(s.adjustments.maghrib||0)+(s.methodAdjustments.maghrib||0),Y=(s.adjustments.isha||0)+(s.methodAdjustments.isha||0);this.fajr=C(O(o,K),s.rounding),this.sunrise=C(O(i,Q),s.rounding),this.dhuhr=C(O(a,k),s.rounding),this.asr=C(O(u,G),s.rounding),this.sunset=C(h,s.rounding),this.maghrib=C(O(c,U),s.rounding),this.isha=C(O(d,Y),s.rounding)}timeForPrayer(e){return e===f.Fajr?this.fajr:e===f.Sunrise?this.sunrise:e===f.Dhuhr?this.dhuhr:e===f.Asr?this.asr:e===f.Maghrib?this.maghrib:e===f.Isha?this.isha:null}currentPrayer(e=new Date){return e>=this.isha?f.Isha:e>=this.maghrib?f.Maghrib:e>=this.asr?f.Asr:e>=this.dhuhr?f.Dhuhr:e>=this.sunrise?f.Sunrise:e>=this.fajr?f.Fajr:f.None}nextPrayer(e=new Date){return e>=this.isha?f.None:e>=this.maghrib?f.Isha:e>=this.asr?f.Maghrib:e>=this.dhuhr?f.Asr:e>=this.sunrise?f.Dhuhr:e>=this.fajr?f.Sunrise:f.Fajr}}const z=[{id:"Singapore",name:"Singapore (Standar Asia Tenggara)",method:S.Singapore},{id:"MuslimWorldLeague",name:"Muslim World League",method:S.MuslimWorldLeague},{id:"Egyptian",name:"Egyptian General Authority",method:S.Egyptian},{id:"Karachi",name:"Karachi (Hanafi)",method:S.Karachi},{id:"UmmAlQura",name:"Umm Al-Qura (Makkah)",method:S.UmmAlQura},{id:"Dubai",name:"Dubai",method:S.Dubai},{id:"Qatar",name:"Qatar",method:S.Qatar},{id:"Kuwait",name:"Kuwait",method:S.Kuwait},{id:"MoonsightingCommittee",name:"Moonsighting Committee",method:S.MoonsightingCommittee},{id:"NorthAmerica",name:"North America (ISNA)",method:S.NorthAmerica}];function bt(){const t=W("rq-user-coords",{lat:-6.2088,lng:106.8456}),e=W("rq-location-name","Jakarta"),n=W("rq-prayer-method","Singapore"),s=P(!1),r=P(null),o=V(()=>{const l=new nt(t.value.lat,t.value.lng),M=new Date,j=(z.find(N=>N.id===n.value)||z[0]).method();return new Mt(l,M,j)}),i=V(()=>o.value?{subuh:u(o.value.fajr),terbit:u(o.value.sunrise),dzuhur:u(o.value.dhuhr),ashar:u(o.value.asr),maghrib:u(o.value.maghrib),isya:u(o.value.isha)}:null),a=V(()=>{if(!o.value)return null;const l=o.value.nextPrayer();if(l==="none")return{name:"Subuh",time:o.value.fajr};const M={fajr:"Subuh",sunrise:"Terbit",dhuhr:"Dzuhur",asr:"Ashar",maghrib:"Maghrib",isha:"Isya"},p=o.value[l];return{name:M[l]||l,time:p}});function u(l){return l.toLocaleTimeString("id-ID",{hour:"2-digit",minute:"2-digit"})}async function h(){if(!navigator.geolocation){r.value="Geolocation not supported";return}s.value=!0,navigator.geolocation.getCurrentPosition(l=>{c("Lokasi Saya",l.coords.latitude,l.coords.longitude),s.value=!1},l=>{console.error(l),r.value="Gagal mendeteksi lokasi",s.value=!1},{timeout:1e4,maximumAge:6e4})}function c(l,M,p){e.value=l,t.value={lat:M,lng:p}}function d(l){n.value=l}return{times:o,formattedTimes:i,upcomingPrayer:a,locationName:e,selectedMethodId:n,availableMethods:z,detectLocation:h,setLocation:c,setMethod:d,isLoading:s}}export{bt as u};
